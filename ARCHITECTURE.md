# íŒŒì£¼ ì±—ë´‡ ì•„í‚¤í…ì²˜ ë¬¸ì„œ

## ğŸ“‹ ëª©ì°¨
1. [ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”](#ì „ì²´-ì•„í‚¤í…ì²˜-ê°œìš”)
2. [ëª¨ë¸ ë¡œë“œ íë¦„](#ëª¨ë¸-ë¡œë“œ-íë¦„)
3. [API ìš”ì²­ íë¦„](#api-ìš”ì²­-íë¦„)
4. [ì£¼ìš” ì»´í¬ë„ŒíŠ¸](#ì£¼ìš”-ì»´í¬ë„ŒíŠ¸)
5. [ë°ì´í„° íë¦„](#ë°ì´í„°-íë¦„)

---

## ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      í´ë¼ì´ì–¸íŠ¸ (í”„ë¡ íŠ¸ì—”ë“œ)                      â”‚
â”‚                  https://pajufe.vercel.app                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTP/HTTPS
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Django REST API ì„œë²„                       â”‚
â”‚                  https://parangee.store                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  paju_chatbot/urls.py                                â”‚  â”‚
â”‚  â”‚  - /api/chat/* â†’ app.chat.urls                       â”‚  â”‚
â”‚  â”‚  - /api/auth/* â†’ app.auth.urls                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  app.chat    â”‚ â”‚  app.auth    â”‚ â”‚  MySQL DB    â”‚
â”‚  (ì±—ë´‡)      â”‚ â”‚  (ì¸ì¦)      â”‚ â”‚  (ë°ì´í„°)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â”€ ResNet18 ëª¨ë¸ (ì´ë¯¸ì§€ ë¶„ë¥˜)
        â”œâ”€â”€â”€ Azure OpenAI (GPT)
        â””â”€â”€â”€ ChromaDB (RAG - í–‰ì‚¬ ì •ë³´)
```

---

## ëª¨ë¸ ë¡œë“œ íë¦„

### 1. ì„œë²„ ì‹œì‘ ì‹œ ëª¨ë¸ ë¡œë“œ

```
Django ì„œë²„ ì‹œì‘
    â”‚
    â–¼
app/chat/models.py import
    â”‚
    â”œâ”€ 1. config.json ì½ê¸°
    â”‚     â””â”€ /app/config.json
    â”‚         â”œâ”€ num_classes: 11
    â”‚         â”œâ”€ model_path: "paju_model_resnet18_finetuned2.pth"
    â”‚         â””â”€ class_names: [...]
    â”‚
    â”œâ”€ 2. ëª¨ë¸ íŒŒì¼ ê²½ë¡œ ìƒì„±
    â”‚     â””â”€ BASE_DIR / model_path
    â”‚         â””â”€ /app/paju_model_resnet18_finetuned2.pth
    â”‚
    â”œâ”€ 3. ResNet18 ëª¨ë¸ êµ¬ì¡° ìƒì„±
    â”‚     â””â”€ torch_models.resnet18(weights=DEFAULT)
    â”‚         â””â”€ model.fc = Linear(512, 11)  # 11ê°œ í´ë˜ìŠ¤
    â”‚
    â”œâ”€ 4. í•™ìŠµëœ ê°€ì¤‘ì¹˜ ë¡œë“œ
    â”‚     â””â”€ torch.load(model_path)
    â”‚         â””â”€ model.load_state_dict(state_dict)
    â”‚
    â””â”€ 5. ëª¨ë¸ ì„¤ì •
          â”œâ”€ model.to('cpu')
          â””â”€ model.eval()  # í‰ê°€ ëª¨ë“œ
```

### 2. ëª¨ë¸ íŒŒì¼ ê²½ë¡œ

**ë¡œì»¬ ê°œë°œ í™˜ê²½:**
- íŒŒì¼ ìœ„ì¹˜: `app/chat/paju_model_resnet18_finetuned2.pth` (Gitì— í¬í•¨ ì•ˆ ë¨)

**ì„œë²„ ë°°í¬ í™˜ê²½:**
- ì„œë²„ ê²½ë¡œ: `/home/azureuser/app/paju_model_resnet18_finetuned2.pth`
- ì»¨í…Œì´ë„ˆ ê²½ë¡œ: `/app/paju_model_resnet18_finetuned2.pth` (ë³¼ë¥¨ ë§ˆìš´íŠ¸)
- Docker ë³¼ë¥¨: `-v /home/azureuser/app/paju_model_resnet18_finetuned2.pth:/app/paju_model_resnet18_finetuned2.pth`

### 3. ëª¨ë¸ ë¡œë“œ ì½”ë“œ ìœ„ì¹˜

**íŒŒì¼:** `app/chat/models.py` (28-94ë²ˆ ë¼ì¸)

```python
# ëª¨ë“ˆ ë ˆë²¨ì—ì„œ ì‹¤í–‰ (Django ì‹œì‘ ì‹œ ìë™ ë¡œë“œ)
BASE_DIR = Path(__file__).resolve().parent.parent.parent  # /app
config_path = BASE_DIR / "config.json"

# config.json ì½ê¸°
cfg = json.load(open(config_path))

# ëª¨ë¸ ê²½ë¡œ ìƒì„±
model_path = BASE_DIR / cfg["model_path"]  # /app/paju_model_resnet18_finetuned2.pth

# ResNet18 ëª¨ë¸ ìƒì„± ë° ê°€ì¤‘ì¹˜ ë¡œë“œ
model = torch_models.resnet18(weights=DEFAULT)
model.fc = Linear(512, 11)
state_dict = torch.load(model_path)
model.load_state_dict(state_dict)
model.eval()
```

---

## API ìš”ì²­ íë¦„

### 1. í…ìŠ¤íŠ¸ ì±—ë´‡ ìš”ì²­

```
POST /api/chat/text/
    â”‚
    â–¼
app/chat/views.py::text_chat_view()
    â”‚
    â”œâ”€ request.data
    â”‚   â”œâ”€ message: "íŒŒì£¼ ì¶œíŒë‹¨ì§€ í–‰ì‚¬ ì•Œë ¤ì¤˜"
    â”‚   â””â”€ session_id: "user123"
    â”‚
    â–¼
app/chat/service.py::text_chat()
    â”‚
    â”œâ”€ í‚¤ì›Œë“œ í™•ì¸: "í–‰ì‚¬", "ì´ë²¤íŠ¸"
    â”‚   â”‚
    â”‚   â”œâ”€ [ìˆìŒ] RAG ê²€ìƒ‰
    â”‚   â”‚   â”‚
    â”‚   â”‚   â–¼
    â”‚   â”‚   retriever.py::retrieve_event_info()
    â”‚   â”‚       â”‚
    â”‚   â”‚       â”œâ”€ ChromaDB ì—°ê²°
    â”‚   â”‚       â”œâ”€ Azure OpenAI Embeddings
    â”‚   â”‚       â””â”€ similarity_search(query, k=2)
    â”‚   â”‚           â””â”€ ê´€ë ¨ í–‰ì‚¬ ì •ë³´ ë°˜í™˜
    â”‚   â”‚
    â”‚   â””â”€ [ì—†ìŒ] ì¼ë°˜ ì§ˆë¬¸
    â”‚
    â–¼
app/chat/service.py::ask_gpt()
    â”‚
    â”œâ”€ conversation_sessions[session_id] ê°€ì ¸ì˜¤ê¸°
    â”œâ”€ ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
    â”‚
    â–¼
app/chat/models.py::client (AzureOpenAI)
    â”‚
    â””â”€ client.chat.completions.create()
        â””â”€ GPT ì‘ë‹µ ë°˜í™˜
```

### 2. ì´ë¯¸ì§€ ì±—ë´‡ ìš”ì²­

```
POST /api/chat/image/
    â”‚
    â”œâ”€ request.FILES['file']  (ì´ë¯¸ì§€)
    â”œâ”€ request.data['session_id']
    â”œâ”€ request.data['action']  ("description" | "stamp")
    â””â”€ request.data['message']  (ì„ íƒì‚¬í•­)
    â”‚
    â–¼
app/chat/views.py::image_chat_view()
    â”‚
    â”œâ”€ ì´ë¯¸ì§€ ê²€ì¦
    â”œâ”€ image_bytes = file.read()
    â”‚
    â–¼
app/chat/service.py::image_chat_with_stamp()
    â”‚
    â”œâ”€ 1. ì¥ì†Œ ì˜ˆì¸¡
    â”‚   â”‚
    â”‚   â–¼
    â”‚   app/chat/service.py::predict_place(image_bytes)
    â”‚       â”‚
    â”‚       â”œâ”€ PIL.Imageë¡œ ë³€í™˜
    â”‚       â”œâ”€ transform ì ìš© (ì „ì²˜ë¦¬)
    â”‚       â”‚   â”œâ”€ Resize(224, 224)
    â”‚       â”‚   â”œâ”€ ToTensor()
    â”‚       â”‚   â””â”€ Normalize(mean, std)
    â”‚       â”‚
    â”‚       â–¼
    â”‚       app/chat/models.py::model (ResNet18)
    â”‚           â”‚
    â”‚           â”œâ”€ model(input_tensor)
    â”‚           â”œâ”€ softmax(outputs)
    â”‚           â””â”€ argmax() â†’ ì˜ˆì¸¡ í´ë˜ìŠ¤
    â”‚               â””â”€ class_names[pred_idx] ë°˜í™˜
    â”‚
    â”œâ”€ 2. ì•¡ì…˜ ì²˜ë¦¬
    â”‚   â”‚
    â”‚   â”œâ”€ [action="stamp"] ìŠ¤íƒ¬í”„ ì ë¦½
    â”‚   â”‚   â””â”€ user_stamps[session_id].append(place_name)
    â”‚   â”‚
    â”‚   â””â”€ [action="description"] ì¥ì†Œ ì„¤ëª…
    â”‚       â”‚
    â”‚       â–¼
    â”‚       app/chat/service.py::ask_gpt()
    â”‚           â””â”€ GPTë¡œ ì¥ì†Œ ì„¤ëª… ìƒì„±
    â”‚
    â””â”€ 3. DB ì €ì¥ (ë¡œê·¸ì¸ ì‚¬ìš©ì)
        â”‚
        â”œâ”€ UserImage ì €ì¥
        â””â”€ Stamp ì €ì¥ (ìŠ¤íƒ¬í”„ ì ë¦½ ì‹œ)
```

---

## ì£¼ìš” ì»´í¬ë„ŒíŠ¸

### 1. ëª¨ë¸ ë ˆì´ì–´ (`app/chat/models.py`)

**ì—­í• :**
- ResNet18 ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ ë¡œë“œ ë° ê´€ë¦¬
- Azure OpenAI í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
- ì´ë¯¸ì§€ ì „ì²˜ë¦¬ transform ì •ì˜
- Django ORM ëª¨ë¸ ì •ì˜ (Stamp, Reward, ClaimedReward, UserImage)

**ì£¼ìš” ë³€ìˆ˜:**
- `model`: ResNet18 ëª¨ë¸ (ì „ì—­ ë³€ìˆ˜)
- `transform`: ì´ë¯¸ì§€ ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
- `class_names`: 11ê°œ ì¥ì†Œ í´ë˜ìŠ¤ ì´ë¦„
- `client`: AzureOpenAI í´ë¼ì´ì–¸íŠ¸

### 2. ì„œë¹„ìŠ¤ ë ˆì´ì–´ (`app/chat/service.py`)

**ì—­í• :**
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
- ëª¨ë¸ê³¼ GPTë¥¼ í™œìš©í•œ ì±—ë´‡ ê¸°ëŠ¥
- ì„¸ì…˜ ê´€ë¦¬ (ëŒ€í™” íˆìŠ¤í† ë¦¬, ìŠ¤íƒ¬í”„)

**ì£¼ìš” í•¨ìˆ˜:**
- `text_chat()`: í…ìŠ¤íŠ¸ ê¸°ë°˜ ì±—ë´‡
- `image_chat_with_stamp()`: ì´ë¯¸ì§€ ê¸°ë°˜ ì¥ì†Œ ì¸ì‹ ë° ì²˜ë¦¬
- `predict_place()`: ì´ë¯¸ì§€ì—ì„œ ì¥ì†Œ ì˜ˆì¸¡
- `ask_gpt()`: Azure OpenAI GPT í˜¸ì¶œ

### 3. ë·° ë ˆì´ì–´ (`app/chat/views.py`)

**ì—­í• :**
- HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
- API ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
- ì¸ì¦ ë° ê¶Œí•œ ì²˜ë¦¬

**ì£¼ìš” ì—”ë“œí¬ì¸íŠ¸:**
- `GET /api/chat/greeting/`: ì¸ì‚¿ë§
- `POST /api/chat/text/`: í…ìŠ¤íŠ¸ ì±—ë´‡
- `POST /api/chat/image/`: ì´ë¯¸ì§€ ì±—ë´‡
- `GET /api/chat/stamps/<session_id>/`: ìŠ¤íƒ¬í”„ ëª©ë¡

### 4. RAG ì‹œìŠ¤í…œ (`retriever.py`)

**ì—­í• :**
- ChromaDB ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
- Azure OpenAI Embeddingsë¡œ ì¿¼ë¦¬ ì„ë² ë”©
- ìœ ì‚¬ë„ ê²€ìƒ‰ìœ¼ë¡œ ê´€ë ¨ í–‰ì‚¬ ì •ë³´ ë°˜í™˜

**ë°ì´í„° íë¦„:**
```
ì‚¬ìš©ì ì§ˆë¬¸ â†’ Embedding â†’ ChromaDB ê²€ìƒ‰ â†’ ê´€ë ¨ í–‰ì‚¬ ì •ë³´ â†’ GPT í”„ë¡¬í”„íŠ¸
```

---

## ë°ì´í„° íë¦„

### 1. ì´ë¯¸ì§€ ë¶„ë¥˜ íŒŒì´í”„ë¼ì¸

```
ì´ë¯¸ì§€ ì—…ë¡œë“œ
    â”‚
    â–¼
PIL.Image.open() â†’ RGB ë³€í™˜
    â”‚
    â–¼
transform (ì „ì²˜ë¦¬)
    â”œâ”€ Resize(224, 224)
    â”œâ”€ ToTensor()
    â””â”€ Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
    â”‚
    â–¼
Tensor [1, 3, 224, 224]
    â”‚
    â–¼
ResNet18 ëª¨ë¸
    â”œâ”€ Conv Layers
    â”œâ”€ BatchNorm
    â”œâ”€ ReLU
    â”œâ”€ MaxPool
    â”œâ”€ ResNet Blocks (x4)
    â””â”€ FC Layer (512 â†’ 11)
    â”‚
    â–¼
Output [1, 11] (11ê°œ í´ë˜ìŠ¤ì— ëŒ€í•œ ë¡œì§“)
    â”‚
    â–¼
Softmax â†’ í™•ë¥  ë¶„í¬
    â”‚
    â–¼
Argmax â†’ ì˜ˆì¸¡ í´ë˜ìŠ¤ ì¸ë±ìŠ¤
    â”‚
    â–¼
class_names[pred_idx] â†’ "íŒŒì£¼ì¶œíŒë„ì‹œ SbgíŒŒì£¼ì‚¬ì˜¥"
```

### 2. í…ìŠ¤íŠ¸ ì±—ë´‡ íŒŒì´í”„ë¼ì¸

```
ì‚¬ìš©ì í…ìŠ¤íŠ¸ ì…ë ¥
    â”‚
    â–¼
í‚¤ì›Œë“œ í™•ì¸ ("í–‰ì‚¬", "ì´ë²¤íŠ¸")
    â”‚
    â”œâ”€ [ìˆìŒ] RAG ê²€ìƒ‰
    â”‚   â”‚
    â”‚   â–¼
    â”‚   ChromaDB similarity_search()
    â”‚   â”‚
    â”‚   â–¼
    â”‚   ê´€ë ¨ í–‰ì‚¬ ì •ë³´ (top_k=2)
    â”‚   â”‚
    â”‚   â–¼
    â”‚   GPT í”„ë¡¬í”„íŠ¸ ìƒì„±
    â”‚   â””â”€ "ì‚¬ìš©ìê°€ '...'ë¼ê³  ë¬¼ì—ˆì–´. ì•„ë˜ëŠ” ê´€ë ¨ í–‰ì‚¬ ì •ë³´ì•¼: ..."
    â”‚
    â””â”€ [ì—†ìŒ] ì¼ë°˜ ì§ˆë¬¸
        â”‚
        â–¼
        GPT í”„ë¡¬í”„íŠ¸ ìƒì„±
        â””â”€ "ì‚¬ìš©ìê°€ '...'ë¼ê³  ë¬¼ì—ˆì–´. íŒŒì£¼ ì¶œíŒë‹¨ì§€ ê´€ë ¨ì´ë©´..."
    â”‚
    â–¼
Azure OpenAI GPT í˜¸ì¶œ
    â”‚
    â”œâ”€ conversation_historyì— ì¶”ê°€
    â””â”€ GPT ì‘ë‹µ ë°˜í™˜
```

### 3. ì„¸ì…˜ ê´€ë¦¬

```
ì„¸ì…˜ ID ìƒì„±/ì „ë‹¬
    â”‚
    â”œâ”€ conversation_sessions[session_id]
    â”‚   â””â”€ ëŒ€í™” íˆìŠ¤í† ë¦¬ ì €ì¥
    â”‚       â”œâ”€ {"role": "system", "content": SYSTEM_PROMPT}
    â”‚       â”œâ”€ {"role": "user", "content": "..."}
    â”‚       â””â”€ {"role": "assistant", "content": "..."}
    â”‚
    â””â”€ user_stamps[session_id]
        â””â”€ ìŠ¤íƒ¬í”„ ëª©ë¡ ì €ì¥
            â””â”€ ["íŒŒì£¼ì¶œíŒë„ì‹œ SbgíŒŒì£¼ì‚¬ì˜¥", "milkbook", ...]
```

---

## ë°°í¬ ì•„í‚¤í…ì²˜

### Docker ì»¨í…Œì´ë„ˆ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Docker Container                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  /app (WORKDIR)                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ manage.py                     â”‚  â”‚
â”‚  â”‚  â”œâ”€ config.json                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ paju_model_resnet18_...pth   â”‚  â”‚ â† ë³¼ë¥¨ ë§ˆìš´íŠ¸
â”‚  â”‚  â”œâ”€ app/                          â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ chat/                      â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”œâ”€ models.py               â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”œâ”€ service.py              â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€ views.py                â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ auth/                      â”‚  â”‚
â”‚  â”‚  â””â”€ paju_chatbot/                 â”‚  â”‚
â”‚  â”‚     â””â”€ settings.py                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²
         â”‚ ë³¼ë¥¨ ë§ˆìš´íŠ¸
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì„œë²„ í˜¸ìŠ¤íŠ¸ (/home/azureuser/app)   â”‚
â”‚  â”œâ”€ paju_model_resnet18_finetuned2.pth â”‚
â”‚  â”œâ”€ media/                          â”‚
â”‚  â””â”€ staticfiles/                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°°í¬ í”„ë¡œì„¸ìŠ¤

```
1. GitHub Push
    â”‚
    â–¼
2. GitHub Actions (CI/CD)
    â”œâ”€ Docker ì´ë¯¸ì§€ ë¹Œë“œ
    â”œâ”€ Docker Hubì— í‘¸ì‹œ
    â””â”€ ì„œë²„ì— SSH ì ‘ì†
    â”‚
    â–¼
3. deploy.sh ì‹¤í–‰
    â”œâ”€ Docker ì´ë¯¸ì§€ Pull
    â”œâ”€ ëª¨ë¸ íŒŒì¼ í™•ì¸
    â”œâ”€ ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì •ë¦¬
    â””â”€ ìƒˆ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ (ë³¼ë¥¨ ë§ˆìš´íŠ¸)
    â”‚
    â–¼
4. Django ì„œë²„ ì‹œì‘
    â””â”€ ëª¨ë¸ ìë™ ë¡œë“œ
```

---

## ì£¼ìš” ì„¤ì • íŒŒì¼

### 1. `config.json`
```json
{
  "num_classes": 11,
  "model_path": "paju_model_resnet18_finetuned2.pth",
  "class_names": [
    "íŒŒì£¼ì¶œíŒë„ì‹œ SbgíŒŒì£¼ì‚¬ì˜¥",
    "milkbook",
    ...
  ]
}
```

### 2. í™˜ê²½ ë³€ìˆ˜ (`.env`)
```
# Azure OpenAI
AZURE_OPENAI_KEY=...
AZURE_OPENAI_ENDPOINT=...
AZURE_OPENAI_API_VERSION=...
AZURE_OPENAI_DEPLOYMENT=...

# Azure Embeddings
AZURE_EMBED_KEY=...
AZURE_EMBED_ENDPOINT=...
AZURE_EMBED_API_VERSION=...
AZURE_EMBED_DEPLOYMENT=...

# Database
DB_NAME=paju
DB_USER=root
DB_PASSWORD=...
DB_HOST=localhost
DB_PORT=3306
```

---

## ëª¨ë¸ ì •ë³´

### ResNet18 ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸

- **ì•„í‚¤í…ì²˜**: ResNet18
- **ì…ë ¥**: RGB ì´ë¯¸ì§€ (224x224)
- **ì¶œë ¥**: 11ê°œ í´ë˜ìŠ¤ í™•ë¥ 
- **í´ë˜ìŠ¤**: íŒŒì£¼ ì¶œíŒë‹¨ì§€ì˜ 11ê°œ ì¥ì†Œ
- **í•™ìŠµ**: íŒŒì¸íŠœë‹ëœ ê°€ì¤‘ì¹˜ ì‚¬ìš©
- **ì¶”ë¡ **: CPU ëª¨ë“œ (eval)

### í´ë˜ìŠ¤ ëª©ë¡
1. íŒŒì£¼ì¶œíŒë„ì‹œ SbgíŒŒì£¼ì‚¬ì˜¥
2. milkbook
3. ê¹€ì˜ì‚¬ ì‚¬ì„œì 
4. ë¬¸í•™ë™ë„¤
5. ì¶œíŒë‹¨ì§€ ë¶ì¹´í˜ëˆˆ
6. ì—´í™”ë‹¹
7. ì¶œíŒë‹¨ì§€ ì€í•˜ìˆ˜ ì¶œíŒì‚¬
8. ì¶œíŒë‹¨ì§€ ìŒì•…ì„¸ê³„
9. ì¶œíŒë‹¨ì§€ ì§€í˜œì˜ìˆ²
10. ì¶œíŒë‹¨ì§€ ì–´ë¦°ì´ì§‘
11. íŒŒì¸ë“œì•„ì›ƒ

---

## ì„±ëŠ¥ ìµœì í™”

1. **ëª¨ë¸ ë¡œë“œ**: ì„œë²„ ì‹œì‘ ì‹œ í•œ ë²ˆë§Œ ë¡œë“œ (ì „ì—­ ë³€ìˆ˜)
2. **ì„¸ì…˜ ê´€ë¦¬**: ë©”ëª¨ë¦¬ ê¸°ë°˜ (in-memory)
3. **ì´ë¯¸ì§€ ì „ì²˜ë¦¬**: PyTorch transforms ì‚¬ìš©
4. **ëª¨ë¸ ì¶”ë¡ **: `torch.no_grad()` ì‚¬ìš© (ê·¸ë˜ë””ì–¸íŠ¸ ê³„ì‚° ë¹„í™œì„±í™”)

---

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **ì¸ì¦**: JWT í† í° ê¸°ë°˜ ì¸ì¦
2. **CORS**: í—ˆìš©ëœ ë„ë©”ì¸ë§Œ ì ‘ê·¼ ê°€ëŠ¥
3. **íŒŒì¼ ì—…ë¡œë“œ**: ì´ë¯¸ì§€ íŒŒì¼ë§Œ í—ˆìš©
4. **í™˜ê²½ ë³€ìˆ˜**: ë¯¼ê°í•œ ì •ë³´ëŠ” `.env` íŒŒì¼ ì‚¬ìš©

---

## í™•ì¥ ê°€ëŠ¥ì„±

1. **ëª¨ë¸ ì—…ë°ì´íŠ¸**: `config.json`ì˜ `model_path`ë§Œ ë³€ê²½
2. **ìƒˆ í´ë˜ìŠ¤ ì¶”ê°€**: `config.json`ì˜ `class_names`ì™€ `num_classes` ìˆ˜ì •
3. **RAG í™•ì¥**: ChromaDBì— ë” ë§ì€ í–‰ì‚¬ ì •ë³´ ì¶”ê°€
4. **ì„¸ì…˜ ì €ì¥**: í˜„ì¬ëŠ” ë©”ëª¨ë¦¬, í•„ìš”ì‹œ Redisë¡œ í™•ì¥ ê°€ëŠ¥

